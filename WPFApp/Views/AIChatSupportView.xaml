<Window
    x:Class="WPFApp.Views.AIChatSupportView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:WPFApp.Converters"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="Trợ lý AI Cai Thuốc Lá"
    Width="400"
    Height="600"
    WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <conv:BoolToAlignmentConverter x:Key="BoolToAlignmentConverter" />
        <conv:BoolToBrushConverter x:Key="BoolToBrushConverter" />
        <conv:BoolToTextBrushConverter x:Key="BoolToTextBrushConverter" />
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Border Padding="15" Background="#1976D2">
            <TextBlock
                HorizontalAlignment="Center"
                FontWeight="Bold"
                Foreground="White"
                Text="TRỢ LÝ AI" />
        </Border>

        <!--  Chat Messages  -->
        <ScrollViewer
            Grid.Row="1"
            Padding="10"
            VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Messages}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,5">
                            <Border
                                MaxWidth="280"
                                Padding="10"
                                HorizontalAlignment="{Binding IsFromUser, Converter={StaticResource BoolToAlignmentConverter}}"
                                Background="{Binding IsFromUser, Converter={StaticResource BoolToBrushConverter}}"
                                CornerRadius="10">
                                <TextBlock
                                    FontSize="14"
                                    Foreground="{Binding IsFromUser, Converter={StaticResource BoolToTextBrushConverter}}"
                                    Text="{Binding Content}"
                                    TextWrapping="Wrap" />
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!--  Input Box  -->
        <Border
            Grid.Row="2"
            Background="White"
            BorderBrush="#E0E0E0"
            BorderThickness="0,1,0,0">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBox
                    materialDesign:HintAssist.Hint="Nhập câu hỏi..."
                    AcceptsReturn="False"
                    KeyDown="TextBox_KeyDown"
                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                    Text="{Binding CurrentMessage, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    Grid.Column="1"
                    Margin="5,0,0,0"
                    Background="#1976D2"
                    Command="{Binding SendCommand}"
                    Foreground="White"
                    Style="{StaticResource MaterialDesignIconButton}">
                    <materialDesign:PackIcon Kind="Send" />
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>