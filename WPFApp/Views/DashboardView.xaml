<Window
    x:Class="WPFApp.Views.DashboardView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:WPFApp.Converters"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="Tổng quan"
    Width="1000"
    Height="700"
    FontFamily="Segoe UI"
    WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <conv:ZeroToVisibilityConverter x:Key="ZeroToVisibilityConverter" />

        <!--  Styles và Converters  -->
        <Style TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="10" />
            <Setter Property="Padding" Value="15" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect
                        BlurRadius="10"
                        ShadowDepth="2"
                        Color="#10000000" />
                </Setter.Value>
            </Setter>
        </Style>

        <Style
            x:Key="PrimaryButton"
            BasedOn="{StaticResource MaterialDesignRaisedButton}"
            TargetType="Button">
            <Setter Property="Width" Value="180" />
            <Setter Property="Height" Value="60" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Background" Value="#1976D2" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <Style
            x:Key="SecondaryButton"
            BasedOn="{StaticResource MaterialDesignOutlinedButton}"
            TargetType="Button">
            <Setter Property="Width" Value="160" />
            <Setter Property="Height" Value="50" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="FontSize" Value="13" />
        </Style>

        <Style x:Key="StatCard" TargetType="materialDesign:Card">
            <Setter Property="Width" Value="220" />
            <Setter Property="Height" Value="120" />
            <Setter Property="Background" Value="#FAFAFA" />
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Trong phần Header Section  -->
        <Border
            Grid.Row="0"
            Padding="15"
            Background="#1976D2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Logo/Title  -->
                <StackPanel
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
                    <materialDesign:PackIcon
                        Width="32"
                        Height="32"
                        Foreground="White"
                        Kind="ViewDashboard" />
                    <TextBlock
                        Margin="10,0,0,0"
                        FontSize="22"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="TỔNG QUAN CAI THUỐC LÁ" />
                </StackPanel>

                <!--  Profile  -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button
                        Click="GoToProfileButton_Click"
                        Style="{StaticResource MaterialDesignIconButton}"
                        ToolTip="Hồ sơ cá nhân">
                        <materialDesign:PackIcon
                            Width="24"
                            Height="24"
                            Foreground="White"
                            Kind="AccountCircle" />
                    </Button>

                    <!--  Notification  -->
                    <Button Click="GotoNotificationButton_Click" Style="{StaticResource MaterialDesignIconButton}">
                        <Grid>
                            <materialDesign:PackIcon
                                Width="24"
                                Height="24"
                                Foreground="White"
                                Kind="Bell" />
                            <Border
                                x:Name="NotificationBadge"
                                Width="16"
                                Height="16"
                                Margin="-5,-5,0,0"
                                VerticalAlignment="Top"
                                Background="#FF5252"
                                CornerRadius="8"
                                Visibility="{Binding UnreadNotificationCount, Converter={StaticResource ZeroToVisibilityConverter}}">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="10"
                                    FontWeight="Bold"
                                    Foreground="White"
                                    Text="{Binding UnreadNotificationCount}" />
                            </Border>
                        </Grid>
                    </Button>


                    <!--  Logout  -->
                    <Button
                        Click="Button_Click"
                        Command="{Binding LogoutCommand}"
                        Style="{StaticResource MaterialDesignIconButton}">
                        <StackPanel Margin="5,0" Orientation="Horizontal">
                            <materialDesign:PackIcon
                                Width="24"
                                Height="24"
                                Foreground="White"
                                Kind="Logout" />
                            <TextBlock
                                Margin="5,0,0,0"
                                VerticalAlignment="Center"
                                Foreground="White" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!--  Main Content  -->
        <ScrollViewer Grid.Row="1" Padding="15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Quick Stats Row  -->
                <StackPanel
                    Grid.Row="0"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal">
                    <materialDesign:Card Style="{StaticResource StatCard}">
                        <StackPanel>
                            <TextBlock
                                FontSize="13"
                                Foreground="#757575"
                                Text="Số ngày cai thuốc" />
                            <TextBlock
                                Margin="0,5"
                                FontSize="28"
                                FontWeight="Bold"
                                Text="27" />
                            <TextBlock
                                FontSize="11"
                                Foreground="#4CAF50"
                                Text="+5 ngày so với tuần trước" />
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Style="{StaticResource StatCard}">
                        <StackPanel>
                            <TextBlock
                                FontSize="13"
                                Foreground="#757575"
                                Text="Số điếu thuốc tiết kiệm" />
                            <TextBlock
                                Margin="0,5"
                                FontSize="28"
                                FontWeight="Bold"
                                Text="135" />
                            <TextBlock
                                FontSize="11"
                                Foreground="#4CAF50"
                                Text="~1,350,000 VND" />
                        </StackPanel>
                    </materialDesign:Card>

                    <materialDesign:Card Style="{StaticResource StatCard}">
                        <StackPanel>
                            <TextBlock
                                FontSize="13"
                                Foreground="#757575"
                                Text="Sức khỏe cải thiện" />
                            <TextBlock
                                Margin="0,5"
                                FontSize="28"
                                FontWeight="Bold"
                                Text="42%" />
                            <ProgressBar
                                Height="8"
                                Margin="0,5"
                                Foreground="#4CAF50"
                                Value="42" />
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!--  Primary Actions  -->
                <WrapPanel
                    Grid.Row="1"
                    Margin="0,20"
                    HorizontalAlignment="Center">
                    <Button Click="GoToQuitPlanButton_Click" Style="{StaticResource PrimaryButton}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon
                                Width="24"
                                Margin="0,0,8,0"
                                Kind="CalendarEdit" />
                            <TextBlock Text="Kế hoạch cai thuốc" />
                        </StackPanel>
                    </Button>

                    <Button Click="GoToSmokingStatusButton_Click" Style="{StaticResource PrimaryButton}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon
                                Width="24"
                                Margin="0,0,8,0"
                                Kind="ChartLine" />
                            <TextBlock Text="Tiến trình" />
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource PrimaryButton}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon
                                Width="24"
                                Margin="0,0,8,0"
                                Kind="MessageText" />
                            <TextBlock Text="Hỗ trợ từ Coach" />
                        </StackPanel>
                    </Button>
                </WrapPanel>

                <!--  Recent Activity  -->
                <materialDesign:Card
                    Grid.Row="2"
                    Margin="10"
                    Padding="0">
                    <StackPanel>
                        <TextBlock
                            Margin="15,10"
                            FontSize="16"
                            FontWeight="Bold"
                            Text="HOẠT ĐỘNG GẦN ĐÂY" />
                        <Separator />
                        <ListView BorderThickness="0" ItemsSource="{Binding RecentActivities}">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="10,5" Orientation="Horizontal">
                                        <materialDesign:PackIcon
                                            Width="24"
                                            Margin="0,0,10,0"
                                            Foreground="#1976D2"
                                            Kind="{Binding IconKind}" />
                                        <StackPanel>
                                            <TextBlock FontWeight="SemiBold" Text="{Binding Title}" />
                                            <TextBlock
                                                FontSize="13"
                                                Foreground="#757575"
                                                Text="{Binding Description}" />
                                            <TextBlock
                                                FontSize="11"
                                                Foreground="#9E9E9E"
                                                Text="{Binding Time, StringFormat='{}{0:HH:mm dd/MM}'}" />
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>
        </ScrollViewer>

        <!--  Navigation Footer  -->
        <Border
            Grid.Row="2"
            Background="#F5F5F5"
            BorderBrush="#E0E0E0"
            BorderThickness="0,1,0,0">
            <UniformGrid
                Margin="10"
                HorizontalAlignment="Center"
                Columns="6">
                <Button Click="GoToSmokingStatusButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="Smoking" />
                        <TextBlock Margin="0,5,0,0" Text="Tình trạng" />
                    </StackPanel>
                </Button>

                <Button Click="GoToAchievementButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="Trophy" />
                        <TextBlock Margin="0,5,0,0" Text="Thành tích" />
                    </StackPanel>
                </Button>

                <Button Click="GoToMembershipButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="AccountStar" />
                        <TextBlock Margin="0,5,0,0" Text="Thành viên" />
                    </StackPanel>
                </Button>

                <Button Click="GoToCommunityButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="AccountGroup" />
                        <TextBlock Margin="0,5,0,0" Text="Cộng đồng" />
                    </StackPanel>
                </Button>

                <Button Click="GoToCoachListButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="AccountMultiple" />
                        <TextBlock Margin="0,5,0,0" Text="Huấn luyện viên" />
                    </StackPanel>
                </Button>

                <Button Click="GoToAIChatSupportButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="Robot" />
                        <TextBlock Margin="0,5,0,0" Text="Hỗ trợ AI" />
                    </StackPanel>
                </Button>

                <Button Click="GoToFeedbackButton_Click" Style="{StaticResource SecondaryButton}">
                    <StackPanel>
                        <materialDesign:PackIcon
                            Width="20"
                            Height="20"
                            Kind="MessageAlert" />
                        <TextBlock Margin="0,5,0,0" Text="Phản hồi" />
                    </StackPanel>
                </Button>
            </UniformGrid>
        </Border>
    </Grid>
</Window>